groups:
  - name: embedder_alerts
    rules:
      - alert: HighErrorRate
        expr: rate(embed_requests_total{status="error"}[5m]) > 0.05
        labels:
          severity: warning
        annotations:
          summary: "High error rate detected"

      - alert: HighLatency
        expr: histogram_quantile(0.95, rate(embed_request_duration_seconds_bucket[5m])) > 2
        labels:
          severity: warning
        annotations:
          summary: "95th percentile latency > 2s"

      - alert: HighMemoryUsage
        expr: python_memory_rss_bytes / 1024 / 1024 > 1500
        labels:
          severity: critical
        annotations:
          summary: "Memory usage > 1.5GB"
